{
  "hash": "229ec18df49e358260c594a70da85824",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Equivalence Tests Using {marginaleffects}\"\nsubtitle: \"Reproducing the Clark and Golder (2006) Example from Rainey (2014)\"\nauthor: \"Carlisle Rainey\"\ndate: \"2023-08-18\"\ncategories: [hypothesis tests, confidence intervals, equivalence tests, TOSTs, negligible effects, computing, R, marginaleffects]\ndescription: \"In this post, I try out the {marginaleffects} package to conduct two one-sided tests (TOSTs) to test a hypothesis of a negligible effect (i.e., equivalence testing).\"\nimage: \"rainey-2014-cg-example.png\"\nreference-location: margin\ntoc: false\ntwitter-card:\n  card-style: summary_large_image\n  image: \"twitter-card.png\"\n  title: \"Equivalence Tests with {marginaleffects}\"  # less than 55 chars\n  description: \"Reproducing the Clark and Golder (2006) example from Rainey (2014)\"  # less than 125 chars\nopen-graph:   \n  image: \"twitter-card.png\"\n  title: \"Equivalence Tests with {marginaleffects}\"  # less than 55 chars\n  description: \"Reproducing the Clark and Golder (2006) example from Rainey (2014)\"  # less than 125 chars\ncode-annotations: hover\ncode-fold: false\nexecute: \n  cache: false\ndraft: false\nbibliography: references.bib\n---\n\n\n\n## Background on arguing for a negligible effect\n\nI remember sitting in a talk while I was a graduate student, and the speaker said something like: \"I expect no effect here, and, just as I expected, the difference is not statistically significant.\" Of course, that's not a compelling argument for a null effect. A lack of statistical significance is an absence of evidence for an effect; it is not evidence of an absence of an effect.\n\nBut I saw this approach taken again and again in published work. (And still do!)\n\nMy first publication was an *AJPS* article [@rainey2014] ([Ungated PDF](https://www.carlislerainey.com/papers/nme.pdf)) explaining why this doesn't work well and how to do it better.\n\nHere's what I wrote in that paper:\n\n> Hypothesis testing is a powerful empirical argument not because it shows that the data are consistent with the research hypothesis, but because it shows that the data are inconsistent with other hypotheses (i.e., the null hypothesis). However, researchers sometimes reverse this logic when arguing for a negligible effect, showing only that the data are consistent with \"no effect\" and failing to show that the data are inconsistent with meaningful effects. When researchers argue that a variable has \"no effect\" because its confidence interval contains zero, they take no steps to rule out large, meaningful effects, making the empirical claim considerably less persuasive . [@altman1995; @gill1999; @nickerson2000]\n\nBut here's a critical point, it's impossible to reject every hypothesis except *exactly* no effect. Instead, the researcher must define a range of substantively \"negligible\" effects. The researcher *can* reject the null hypothesis that the effect falls outside this range of negligible effects. However, this requires a substantive judgement about those effects that are negligible and those that are not.\n\nHere's what I wrote:\n\n> Researchers who wish to argue for a negligible effect must precisely define the set of effects that are deemed \"negligible\" as well as the set of effects that are \"meaningful.\" This requires defining the smallest substantively meaningful effect, which I denote as $m$. The definition must be debated by substantive scholars for any given context because the appropriate $m$ varies widely across applications.\n\n## Clark and Golder (2006)\n\n@clark2006 offer a nice example of this sort of hypothesis. I'll refer you there and to @rainey2014 for a complete discussion of their idea, but I'll motivate it briefly here.\n\nExplaining why a country might have only a few (i.e., two) parties, Clark and Golder write:\n\n> First, it could be the case that the demand for parties is low because there are few social cleavages. In this situation, there would be few parties whether the electoral institutions were permissive or not. Second, it could be the case that the electoral system is not permissive. In this situation, there would be a small number of parties even if the demand for political parties were high. Only a polity characterized by both a high degree of social heterogeneity and a highly permissive electoral system is expected to produce a large number of parties. (p. 683)\n\nThus, they expect that electoral institutions won't matter in socially homogeneous systems. And they expect that social heterogeneity won't matter in electoral systems that are not permissive.\n\n## Reproducing Clark and Golder (2006)\n\nBefore computing their specific quantities of interest, let's reproduce their regression model. Here's their table that we're trying to reproduce.\n\n![](clark-golder-2006-table2.png)\n\nAnd here's a reproduction of their estimates using the `cg2006` data from the [{crdata} package](http://www.carlislerainey.com/crdata/) on GitHub.[^1]\n\n[^1]: Run `?crdata::cg2006` for detailed documentation of this data set.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\nlibrary(sandwich)\nlibrary(modelsummary)\n\n# install my data packages from github\ndevtools::install_github(\"carlislerainey/crdata\")  # only updates if newer version available\n\n# load clark and golder's data set\ncg <- crdata::cg2006\n\n# reproduce their estimates\nf <- enep ~ eneg*log(average_magnitude) + eneg*upper_tier + en_pres*proximity\nfit <- lm(f, data = cg)\n\n# regression table\nmodelsummary(fit, \n             vcov = ~ country, # cluster-robust SE; multiple observations per country\n             fmt = 2, \n             shape = term ~ model + statistic)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n\n      function styleCell_7wpemef4qvgzqe5kqtya(i, j, css_id) {\n          var table = document.getElementById(\"tinytable_7wpemef4qvgzqe5kqtya\");\n          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors\n          if (cell) {\n              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);\n              cell.classList.add(css_id);\n          } else {\n              console.warn(`Cell at (${i}, ${j}) not found.`);\n          }\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_7wpemef4qvgzqe5kqtya');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_7wpemef4qvgzqe5kqtya(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_7wpemef4qvgzqe5kqtya\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: 0, j: 2 },  ], css_id: 'tinytable_css_5yxdj6q8ppedbu38r2wt',}, \n          { positions: [ { i: 18, j: 2 }, { i: 18, j: 1 },  ], css_id: 'tinytable_css_j7jhhfwihktpogp4rpij',}, \n          { positions: [ { i: 10, j: 2 }, { i: 10, j: 1 },  ], css_id: 'tinytable_css_1hdcr2zh6q1ovw9425dz',}, \n          { positions: [ { i: 3, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 2, j: 1 }, { i: 7, j: 1 }, { i: 8, j: 1 }, { i: 9, j: 1 }, { i: 4, j: 2 }, { i: 11, j: 1 }, { i: 12, j: 1 }, { i: 13, j: 1 }, { i: 14, j: 1 }, { i: 15, j: 1 }, { i: 16, j: 1 }, { i: 17, j: 1 }, { i: 12, j: 2 }, { i: 6, j: 1 }, { i: 14, j: 2 }, { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 17, j: 2 }, { i: 5, j: 2 }, { i: 6, j: 2 }, { i: 7, j: 2 }, { i: 8, j: 2 }, { i: 9, j: 2 }, { i: 11, j: 2 }, { i: 16, j: 2 }, { i: 13, j: 2 }, { i: 15, j: 2 },  ], css_id: 'tinytable_css_xbzkpqiogs0aijjbtkek',}, \n          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_9xkd3zka0a874cbnea59',}, \n          { positions: [ { i: 1, j: 1 }, { i: 1, j: 2 },  ], css_id: 'tinytable_css_gi182u7xjtwjbinv4e5i',}, \n          { positions: [ { i: 18, j: 0 },  ], css_id: 'tinytable_css_riykb52b0qg853yk9n3d',}, \n          { positions: [ { i: 10, j: 0 },  ], css_id: 'tinytable_css_ii7gy3ugmj1cw245qvgz',}, \n          { positions: [ { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 7, j: 0 }, { i: 8, j: 0 }, { i: 9, j: 0 }, { i: 14, j: 0 }, { i: 11, j: 0 }, { i: 12, j: 0 }, { i: 13, j: 0 }, { i: 15, j: 0 }, { i: 16, j: 0 }, { i: 17, j: 0 },  ], css_id: 'tinytable_css_vlekgzur4laltls0548k',}, \n          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_jqdrusupnqh0epmu6j7t',}, \n          { positions: [ { i: 1, j: 0 },  ], css_id: 'tinytable_css_qbzn4qr57esute045y9g',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  styleCell_7wpemef4qvgzqe5kqtya(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <style>\n      /* tinytable css entries after */\n      .table td.tinytable_css_5yxdj6q8ppedbu38r2wt, .table th.tinytable_css_5yxdj6q8ppedbu38r2wt { text-align: center; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }\n      .table td.tinytable_css_j7jhhfwihktpogp4rpij, .table th.tinytable_css_j7jhhfwihktpogp4rpij { text-align: center; border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_1hdcr2zh6q1ovw9425dz, .table th.tinytable_css_1hdcr2zh6q1ovw9425dz { text-align: center; border-bottom: solid black 0.05em; }\n      .table td.tinytable_css_xbzkpqiogs0aijjbtkek, .table th.tinytable_css_xbzkpqiogs0aijjbtkek { text-align: center; }\n      .table td.tinytable_css_9xkd3zka0a874cbnea59, .table th.tinytable_css_9xkd3zka0a874cbnea59 { text-align: center; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }\n      .table td.tinytable_css_gi182u7xjtwjbinv4e5i, .table th.tinytable_css_gi182u7xjtwjbinv4e5i { text-align: center; border-bottom: solid #d3d8dc 0.05em; }\n      .table td.tinytable_css_riykb52b0qg853yk9n3d, .table th.tinytable_css_riykb52b0qg853yk9n3d { text-align: left; border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_ii7gy3ugmj1cw245qvgz, .table th.tinytable_css_ii7gy3ugmj1cw245qvgz { text-align: left; border-bottom: solid black 0.05em; }\n      .table td.tinytable_css_vlekgzur4laltls0548k, .table th.tinytable_css_vlekgzur4laltls0548k { text-align: left; }\n      .table td.tinytable_css_jqdrusupnqh0epmu6j7t, .table th.tinytable_css_jqdrusupnqh0epmu6j7t { text-align: left; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }\n      .table td.tinytable_css_qbzn4qr57esute045y9g, .table th.tinytable_css_qbzn4qr57esute045y9g { text-align: left; border-bottom: solid #d3d8dc 0.05em; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_7wpemef4qvgzqe5kqtya\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n<tr>\n<th scope=\"col\" align=\"center\" colspan=1> </th>\n<th scope=\"col\" align=\"center\" colspan=2>(1)</th>\n</tr>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">Est.</th>\n                <th scope=\"col\">S.E.</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>2.92</td>\n                  <td>0.35</td>\n                </tr>\n                <tr>\n                  <td>eneg</td>\n                  <td>0.11</td>\n                  <td>0.14</td>\n                </tr>\n                <tr>\n                  <td>log(average_magnitude)</td>\n                  <td>0.08</td>\n                  <td>0.23</td>\n                </tr>\n                <tr>\n                  <td>upper_tier</td>\n                  <td>-0.06</td>\n                  <td>0.03</td>\n                </tr>\n                <tr>\n                  <td>en_pres</td>\n                  <td>0.26</td>\n                  <td>0.15</td>\n                </tr>\n                <tr>\n                  <td>proximity</td>\n                  <td>-3.10</td>\n                  <td>0.46</td>\n                </tr>\n                <tr>\n                  <td>eneg × log(average_magnitude)</td>\n                  <td>0.26</td>\n                  <td>0.17</td>\n                </tr>\n                <tr>\n                  <td>eneg × upper_tier</td>\n                  <td>0.06</td>\n                  <td>0.02</td>\n                </tr>\n                <tr>\n                  <td>en_pres × proximity</td>\n                  <td>0.68</td>\n                  <td>0.23</td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.</td>\n                  <td>487</td>\n                  <td></td>\n                </tr>\n                <tr>\n                  <td>R2</td>\n                  <td>0.397</td>\n                  <td></td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.</td>\n                  <td>0.387</td>\n                  <td></td>\n                </tr>\n                <tr>\n                  <td>AIC</td>\n                  <td>1672.5</td>\n                  <td></td>\n                </tr>\n                <tr>\n                  <td>BIC</td>\n                  <td>1714.3</td>\n                  <td></td>\n                </tr>\n                <tr>\n                  <td>Log.Lik.</td>\n                  <td>-826.229</td>\n                  <td></td>\n                </tr>\n                <tr>\n                  <td>RMSE</td>\n                  <td>1.32</td>\n                  <td></td>\n                </tr>\n                <tr>\n                  <td>Std.Errors</td>\n                  <td>by: country</td>\n                  <td></td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\nSuccess!\n\nThey use `averge_magnitude` to measure the permissiveness of the electoral system and `eneg` to measure social heterogeneity.\n\n## Using `comparisons()` to compute the effects\n\nNow let's compute the two quantities of interest. Clark and Golder argue for two negligible effects, which I make really concrete below.\n\n-   **Hypothesis 1** Increasing the effective number of ethnic groups from the 10th percentile (1.06) to the 90th percentile (2.48) will not lead to a substantively meaningful change in the effective number of political parties when the district magnitude is one.\n-   **Hypothesis 2** Increasing the district magnitude from one to seven will not lead to a substantively meaningful change in the effective number of political parties when the effective number of ethnic groups is one.\n\nAnd comparing the U.S. and the U.K., I argue that the smallest substantively interesting effect is 0.62. In @rainey2014, I made the plot below. I want to reproduce it with {marginaleffects}.\n\n![](rainey-2014-cg-example.png)\n\nThese differences (and the 90% CIs) are really easy to compute using {marginaleffects}![^2]\n\n[^2]: I'm only doing Clark and Golder's original results, not any of the robustness checks.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nlibrary(marginaleffects)\n\n# the smallest substantively interesting effect\nm <- 0.62\n\n# a data frame setting the values of the \"other\" variables\nX_c <- data.frame(\n  eneg = 1.06,  # low value\n  average_magnitude = 1,  # low value\n  upper_tier = 0,\n  en_pres = 0, \n  proximity = 0\n)\n\n# compute the comparison for eneg and average magnitude\nc <- comparisons(fit,\n            vcov = ~ country,\n            newdata = X_c, \n            variables = list(\"eneg\" = c(1.06, 2.48),         # low to high value\n                             \"average_magnitude\" = c(1, 7)), # low to high value\n            conf_level = 0.90)\n```\n:::\n\n\n\nThis `c` outputted from `comparisons()` is a data frame.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# default print method\nprint(c)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n              Term    Contrast Estimate Std. Error     z Pr(>|z|)    S  5.0 %\n average_magnitude 7 - 1          0.696      0.175 3.973   <0.001 13.8  0.408\n eneg              2.48 - 1.06    0.158      0.204 0.779    0.436  1.2 -0.176\n 95.0 %\n  0.984\n  0.493\n\nType:  response \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# quick look at the bare data frame\nglimpse(c)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 2\nColumns: 19\n$ rowid             <int> 1, 1\n$ term              <chr> \"average_magnitude\", \"eneg\"\n$ contrast          <chr> \"7 - 1\", \"2.48 - 1.06\"\n$ estimate          <dbl> 0.6956014, 0.1584771\n$ std.error         <dbl> 0.1750741, 0.2035052\n$ statistic         <dbl> 3.9731830, 0.7787372\n$ p.value           <dbl> 7.091852e-05, 4.361345e-01\n$ s.value           <dbl> 13.783478, 1.197155\n$ conf.low          <dbl> 0.4076302, -0.1762592\n$ conf.high         <dbl> 0.9835727, 0.4932134\n$ predicted_lo      <dbl> 3.034008, 3.034008\n$ predicted_hi      <dbl> 3.729609, 3.192485\n$ predicted         <dbl> 3.034008, 3.034008\n$ eneg              <dbl> 1.06, 1.06\n$ average_magnitude <dbl> 1, 1\n$ upper_tier        <dbl> 0, 0\n$ en_pres           <dbl> 0, 0\n$ proximity         <dbl> 0, 0\n$ enep              <dbl> 5.75, 5.75\n```\n\n\n:::\n:::\n\n\n\nNow we can just plot the 90% CIs with `ggplot()` and check whether the entire interval falls inside the bounds.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# bind the comparisons together and plot\nggplot(c, aes(x = estimate,\n                 xmin = conf.low,\n                 xmax = conf.high, \n                 y = term)) + \n  geom_vline(xintercept = c(-m, m), linetype = \"dashed\") + \n  geom_errorbarh() + \n  geom_point() \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\nIn this case, we conclude that social heterogeneity (`eneg`) has a negligible effect because the 90% CI only contains substantively negligible values. However, the 90% CI for district magnitude (`average_magnitude`) contains substantively negligible and meaningful values, so we cannot reject the null hypothesis of a meaningful effect.\n\n## Computing the TOST *p*-values using `hypotheses()`\n\nIt's then almost trivial to use the `hypotheses()` function to compute the TOST *p*-values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# hypothesis tests\nhypotheses(c, equivalence = c(-m, m))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n              Term Estimate Std. Error     z Pr(>|z|)    S  5.0 % 95.0 %\n average_magnitude    0.696      0.175 3.973   <0.001 13.8  0.408  0.984\n eneg                 0.158      0.204 0.779    0.436  1.2 -0.176  0.493\n p (NonInf) p (NonSup) p (Equiv)\n     <0.001     0.6671    0.6671\n     <0.001     0.0117    0.0117\n```\n\n\n:::\n:::\n\n\n\nThis doesn't print super-nicely into this document, so let's extract the important parts.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# hypothesis tests, extracting the important pieces\nhypotheses(c, equivalence = c(-m, m)) %>%\n  select(term, estimate, conf.low, conf.high, p.value.equiv)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n              Term Estimate CI low CI high p (Equiv)\n average_magnitude    0.696  0.408   0.984    0.6671\n eneg                 0.158 -0.176   0.493    0.0117\n```\n\n\n:::\n:::\n\n\n\nChecking that the 90% CIs fall within the bounds created by the smallest substantively-meaningful effect is equivalent to checking whether the TOST *p*-value (i.e., the `p(Equiv)` column) is less than 0.05, so our conclusions are (and must be) identical.\n\n## Other references\n\nFor more on effective arguments for no effect, see the following:\n\n-   @lakens2017 and @lakens2018 offer an accessible introduction to equivalences tests for psychologists.\n- @fitzgerald2025 offers and introduction to and argument for equivalence tests for economists.\n-   @kane2024 offers an excellent summary of design considerations when arguing for no effect.\n-   @mccaskey2015 ([Ungated PDF](https://www.carlislerainey.com/papers/meaningful.pdf)) argue that researchers should make \"claims if and only if those claims hold for the entire confidence interval.\" This extends the logic of equivalence testing to a broader collection of possible hypotheses.\n\n## Final thoughts\n\n1.  {marginaleffects} is a great package [@marginaleffects]. I think it's the first package in which the syntax matches the way I think about computing quantities of interest. That said, this is just my first try at it. But I'm very impressed so far.\n2.  The {marginaleffects} [book](https://marginaleffects.com) *Model to Meaning* has a whole [chapter](https://marginaleffects.com/chapters/hypothesis.html#sec-hypothesis_equivalence) on equivalence tests. My only caution is that there is a mismatch between 95% confidence intervals and equivalence tests. By default, {marginaleffects} reports a 95% CI, even when producing a *p*-value for an equivalence test. However, the 90% confidence interval correspondents to a size-5% equivalence test. So if you're using {marginaleffects} to do equivalence tests, I recommend setting `conf_level = 0.90`.[^4]\n3.  For a more recent example, @jares2024 discusses negligible effects and hypothesis tests in a way that I find clear and compelling. It's an excellent model to follow. See pp. 12-13. They \"show that improved compensation outcomes had negligible impacts on Republican farmers’ midterm turnout and campaign contributions, even though such variation in benefits significantly affected farmers' propensity to view the intervention as helpful.\"\n\n[^4]: I would make a similar point about one-sided tests as well, but that's less correct, because it should be a *one-sided* 95% CI.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}